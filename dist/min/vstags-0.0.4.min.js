/* 
*  Name: vstags 
*  Description: Tags - AngularJS reusable UI component 
*  Version: 0.0.4 
*  Author: kekeh 
*  Homepage: http://kekeh.github.io/vstags 
*  License: MIT 
*  Date: 2015-08-24 
*/ 
angular.module('template-vstags-0.0.4.html', []).run(['$templateCache', function($templateCache) {
  $templateCache.put("templates/vstags.html",
    "<div class=vstags><div class=vstagsgroup><div ng-if=showOverlay ng-include=\"'templates/vstagsoverlay.html'\"></div><div class=vstagsarea><div ng-include=\"'templates/vstagsrepeat.html'\"></div></div><span class=vsbtncontainer><button class=vstagsbtn ng-click=\"showOverlay=true\" ng-show=showTagsBtn><span class=\"icon icon-selections\"></span></button> <button class=vstagsbtn ng-click=addNewItem()><span class=icon ng-class=\"{'icon-plus':!showInput,'icon-check':showInput}\"></span></button> <span class=vstagsselectioncounttxt ng-if=showTagsBtn ng-click=\"showOverlay=true\">{{selectedTags.length}}</span></span></div><input class=vstagsinput placeholder={{conf.TYPE_TAG_TXT}} input-focus ng-show=showInput ng-model=inputTxt ng-model-options={debounce:conf.INPUT_DEBOUNCE} ng-keydown=\"keyDown($event)\"><div class=vstagsloader ng-show=\"showInput&&inputTxt!==''&&loadedTags.length>0\"><div class=vstagsloaderitem ng-repeat=\"item in loadedTags track by $index\" ng-click=itemClicked(item) ng-keydown=\"$event.which===13?itemClicked(item):null\" tabindex=0><span class=vstagsloaderitemtxt>{{item}}</span></div></div></div>");
  $templateCache.put("templates/vstagsoverlay.html",
    "<div class=vstagsoverlay ng-mouseleave=closeOverlay()><div class=vstagsoverlaytitle><span class=vstagsoverlaytitletxt>{{selectedTags.length}} {{conf.SEL_TAGS_TXT}}</span> <span class=\"icon icon-cross vsiconoverlaycross\" ng-click=closeOverlay() ng-keydown=\"$event.which===13?closeOverlay():null\" tabindex=0></span></div><div ng-include=\"'templates/vstagsrepeat.html'\"></div></div>");
  $templateCache.put("templates/vstagsrepeat.html",
    "<div class=vsselectedtags ng-repeat=\"item in selectedTags track by $index\"><span class=vstagtext>{{item}}</span> <span class=\"vsiconcross icon icon-cross\" ng-click=removeItem(item) ng-keydown=\"$event.which===13?removeItem(item):null\" tabindex=0></span></div>");
}]);

angular.module("vstags",["template-vstags-0.0.4.html"]).constant("vstagsConf",{INPUT_DEBOUNCE:500,INPUT_FOCUS_EVENT:"vstags.ife",SEL_TAGS_TXT:"tag(s)",TYPE_TAG_TXT:"Type tag here..."}).directive("vstags",["$window",function(a){return{restrict:"EA",templateUrl:"templates/vstags.html",scope:{ngModel:"=?",onLoadTagsFn:"&"},controller:["$scope","vstagsConf",function(a,b){a.conf=b,a.inputTxt="",a.inputFocusEvent=function(){a.$broadcast(a.conf.INPUT_FOCUS_EVENT)}}],link:function(b,c,d){function e(a,c){a!==c&&(b.loadedTags=b.onLoadTagsFn({filter:b.inputTxt}))}function f(){b.ngModel=b.selectedTags}function g(a){b.selectedTags.push(a),f()}function h(){void 0!==d.onLoadTagsFn&&b.$watch("inputTxt",e),b.selectedTags=b.ngModel}b.selectedTags=[],b.loadedTags=[],b.showInput=!1,b.showOverlay=!1;var i=i=angular.element(c[0].querySelector(".vstagsarea")),j=angular.element(a);b.addNewItem=function(){b.showInput=!b.showInput,b.showInput?b.inputFocusEvent():""!==b.inputTxt&&(g(b.inputTxt),b.inputTxt="")},b.removeItem=function(a){var c=b.selectedTags.indexOf(a);-1!==c&&(b.selectedTags.splice(c,1),f())},b.keyDown=function(a){13===a.which&&""!==b.inputTxt&&(g(b.inputTxt),b.inputTxt="",b.showInput=!1)},b.itemClicked=function(a){g(a),b.inputTxt="",b.showInput=!1},b.closeOverlay=function(){b.showOverlay=!1},b.$watch(function(){return i[0].scrollHeight},function(a){b.showTagsBtn=a>34}),j.on("resize",function(){b.$apply()}),h()}}}]).directive("inputFocus",["$timeout",function(a){return{restrict:"A",scope:!1,link:function(b,c){b.$on(b.conf.INPUT_FOCUS_EVENT,function(){a(function(){c[0].focus()})})}}}]);